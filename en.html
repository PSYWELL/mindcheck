<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Self Check | Mind Check</title>
  
  <!-- PWA meta tags -->
  <meta name="theme-color" content="#0a0a0a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="MindCheck">
  <link rel="manifest" href="manifest.json">
  <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 180'><rect fill='%230a0a0a' width='180' height='180' rx='40'/><circle cx='90' cy='75' r='30' fill='none' stroke='%239d8a6e' stroke-width='5'/><path d='M55 130 Q90 105 125 130' fill='none' stroke='%239d8a6e' stroke-width='5' stroke-linecap='round'/></svg>">
  
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Inter:wght@200;300;400;500;600&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-primary: #0a0a0a;
      --bg-secondary: #111111;
      --bg-card: #161616;
      --bg-card-hover: #1a1a1a;
      --bg-input: #1c1c1c;
      
      --accent: #9d8a6e;
      --accent-light: #c4b59d;
      --accent-dim: rgba(157, 138, 110, 0.12);
      --accent-glow: rgba(157, 138, 110, 0.08);
      
      --success: #4a9d7e;
      --success-dim: rgba(74, 157, 126, 0.12);
      
      --text-white: #ffffff;
      --text-primary: #f0f0f0;
      --text-secondary: #a0a0a0;
      --text-tertiary: #666666;
      --text-dim: #444444;
      
      --border: rgba(255,255,255,0.06);
      --border-accent: rgba(157, 138, 110, 0.25);
      --border-success: rgba(74, 157, 126, 0.3);
      
      --font-serif: 'Playfair Display', Georgia, serif;
      --font-sans: 'Inter', -apple-system, sans-serif;
      
      --space-1: 8px;
      --space-2: 16px;
      --space-3: 24px;
      --space-4: 32px;
      --space-5: 40px;
      --space-6: 48px;
      --space-8: 64px;
      --space-10: 80px;
      --space-12: 96px;
      --space-16: 128px;
      
      --radius-sm: 8px;
      --radius-md: 12px;
      --radius-lg: 16px;
      --radius-xl: 24px;
    }

    * { 
      margin: 0; 
      padding: 0; 
      box-sizing: border-box; 
      -webkit-tap-highlight-color: transparent;
      -webkit-font-smoothing: antialiased;
    }

    html { font-size: 16px; scroll-behavior: smooth; }

    body {
      font-family: var(--font-sans);
      font-weight: 300;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.7;
      letter-spacing: -0.01em;
      min-height: 100dvh;
    }

    /* Typography */
    .text-display {
      font-family: var(--font-serif);
      font-size: 2.75rem;
      font-weight: 400;
      line-height: 1.25;
      letter-spacing: -0.02em;
      color: var(--text-white);
    }
    .text-h1 {
      font-family: var(--font-serif);
      font-size: 1.75rem;
      font-weight: 400;
      line-height: 1.35;
      letter-spacing: -0.01em;
      color: var(--text-white);
    }
    .text-h2 {
      font-family: var(--font-sans);
      font-size: 1.375rem;
      font-weight: 500;
      line-height: 1.4;
      letter-spacing: -0.02em;
      color: var(--text-white);
    }
    .text-h3 {
      font-family: var(--font-sans);
      font-size: 1.125rem;
      font-weight: 500;
      line-height: 1.5;
      letter-spacing: -0.01em;
      color: var(--text-white);
    }
    .text-body-lg {
      font-family: var(--font-sans);
      font-size: 1.125rem;
      font-weight: 300;
      line-height: 1.8;
      color: var(--text-secondary);
    }
    .text-body {
      font-family: var(--font-sans);
      font-size: 1rem;
      font-weight: 400;
      line-height: 1.7;
      color: var(--text-primary);
    }
    .text-body-sm {
      font-family: var(--font-sans);
      font-size: 0.9375rem;
      font-weight: 400;
      line-height: 1.6;
      color: var(--text-secondary);
    }
    .text-label {
      font-family: var(--font-sans);
      font-size: 0.6875rem;
      font-weight: 500;
      line-height: 1;
      letter-spacing: 0.15em;
      text-transform: uppercase;
      color: var(--accent);
    }
    .text-caption {
      font-family: var(--font-sans);
      font-size: 0.8125rem;
      font-weight: 400;
      line-height: 1.5;
      color: var(--text-tertiary);
    }
    .text-micro {
      font-family: var(--font-sans);
      font-size: 0.75rem;
      font-weight: 400;
      line-height: 1.4;
      color: var(--text-dim);
    }

    em { font-style: italic; color: var(--accent-light); }
    strong { font-weight: 500; color: var(--text-white); }

    .container { width: 100%; max-width: 800px; margin: 0 auto; padding: 0 var(--space-3); }

    /* Buttons */
    .btn-primary {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: var(--space-2) var(--space-5);
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-light) 100%);
      color: var(--bg-primary);
      font-family: var(--font-sans);
      font-size: 0.9375rem;
      font-weight: 500;
      letter-spacing: 0.01em;
      border: none;
      border-radius: 100px;
      cursor: pointer;
      transition: all 0.4s cubic-bezier(0.16, 1, 0.3, 1);
      box-shadow: 0 0 0 1px rgba(157, 138, 110, 0.3), 0 8px 32px rgba(157, 138, 110, 0.15);
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 0 0 1px rgba(157, 138, 110, 0.5), 0 12px 48px rgba(157, 138, 110, 0.25);
    }
    .btn-primary:active { transform: scale(0.98); }
    .btn-primary.is-disabled {
      background: var(--bg-card) !important;
      color: var(--text-dim) !important;
      box-shadow: none !important;
      cursor: not-allowed !important;
      pointer-events: none !important;
    }

    .btn-ghost {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: 14px var(--space-4);
      background: transparent;
      color: var(--text-secondary);
      font-family: var(--font-sans);
      font-size: 0.875rem;
      font-weight: 400;
      letter-spacing: 0.02em;
      border: 1px solid var(--border);
      border-radius: 100px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .btn-ghost:hover {
      color: var(--accent-light);
      border-color: var(--border-accent);
      background: var(--accent-dim);
    }

    .btn-success {
      display: inline-flex;
      justify-content: center;
      align-items: center;
      padding: var(--space-2) var(--space-5);
      background: var(--success);
      color: white;
      font-family: var(--font-sans);
      font-size: 0.9375rem;
      font-weight: 500;
      border: none;
      border-radius: 100px;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    .btn-success:hover { background: #3d8a6b; }

    /* Input */
    .input-field {
      width: 100%;
      padding: 14px var(--space-2);
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      color: var(--text-white);
      font-family: var(--font-sans);
      font-size: 0.9375rem;
      outline: none;
      transition: all 0.3s ease;
    }
    .input-field::placeholder { color: var(--text-dim); }
    .input-field:focus { border-color: var(--accent); background: var(--bg-card); }

    /* =====================
       Landing
       ===================== */
    .landing { opacity: 1; transition: opacity 0.5s ease; }
    .landing.hidden { display: none; }

    .hero {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: var(--space-10) var(--space-3);
      position: relative;
    }
    .hero::before {
      content: '';
      position: absolute;
      top: 0; left: 50%;
      transform: translateX(-50%);
      width: 600px; height: 600px;
      background: radial-gradient(circle, var(--accent-dim) 0%, transparent 70%);
      pointer-events: none;
      opacity: 0.8;
    }
    .hero-content { position: relative; z-index: 1; max-width: 600px; }
    .hero-label {
      display: inline-block;
      margin-bottom: var(--space-5);
      padding: 10px 20px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 100px;
    }
    .hero-headline { margin-bottom: var(--space-4); }
    .hero-sub { margin-bottom: var(--space-6); }
    .hero-cta { display: flex; flex-direction: column; align-items: center; gap: var(--space-2); }

    .scroll-hint {
      position: absolute;
      bottom: var(--space-5);
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: var(--space-1);
      animation: float 3s ease-in-out infinite;
    }
    .scroll-hint::after {
      content: '';
      width: 1px;
      height: 32px;
      background: linear-gradient(180deg, var(--text-dim) 0%, transparent 100%);
    }
    @keyframes float {
      0%, 100% { transform: translateX(-50%) translateY(0); opacity: 1; }
      50% { transform: translateX(-50%) translateY(8px); opacity: 0.5; }
    }

    .empathy {
      padding: var(--space-16) var(--space-3);
      background: var(--bg-secondary);
    }
    .section-header { text-align: center; margin-bottom: var(--space-8); }
    .section-header .text-label { display: block; margin-bottom: var(--space-2); }

    .symptom-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-2);
      margin-bottom: var(--space-8);
    }
    .symptom-card {
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-4);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: var(--space-3);
    }
    .symptom-card::before {
      content: '';
      position: absolute;
      top: 0; left: 0;
      width: 2px; height: 0;
      background: linear-gradient(180deg, var(--accent) 0%, var(--accent-light) 100%);
      transition: height 0.3s ease;
    }
    .symptom-card:hover { border-color: var(--border-accent); background: var(--bg-card-hover); }
    .symptom-card:hover::before { height: 100%; }
    .symptom-card:hover .symptom-icon { opacity: 1; transform: scale(1.05); }
    
    .symptom-content { flex: 1; }
    .symptom-number { display: block; margin-bottom: var(--space-2); }
    .symptom-text { font-size: 0.9375rem; line-height: 1.6; color: var(--text-primary); }
    
    .symptom-icon {
      width: 56px;
      height: 56px;
      flex-shrink: 0;
      opacity: 0.4;
      transition: all 0.3s ease;
    }
    .symptom-icon svg {
      width: 100%;
      height: 100%;
      stroke: var(--accent-light);
    }

    .message-block {
      position: relative;
      background: var(--bg-card);
      border: 1px solid var(--border-accent);
      border-radius: var(--radius-lg);
      padding: var(--space-6) var(--space-5);
      margin-bottom: var(--space-6);
      text-align: center;
    }
    .message-block::before {
      content: '';
      position: absolute;
      top: -1px; left: var(--space-5); right: var(--space-5);
      height: 1px;
      background: linear-gradient(90deg, transparent 0%, var(--accent) 50%, transparent 100%);
    }

    /* Scarcity Counter */
    .scarcity-counter {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 20px;
      background: var(--accent-dim);
      border: 1px solid var(--border-accent);
      border-radius: 100px;
      margin-bottom: var(--space-4);
    }
    .scarcity-dot {
      width: 8px; height: 8px;
      background: var(--accent);
      border-radius: 50%;
      animation: pulse 2s ease-in-out infinite;
    }
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
    .scarcity-text { font-size: 0.8125rem; color: var(--accent-light); font-weight: 500; }

    .cta-wrapper { text-align: center; }

    .trust {
      padding: var(--space-12) var(--space-3);
      text-align: center;
      border-top: 1px solid var(--border);
    }
    .trust-content { max-width: 480px; margin: 0 auto; }
    .trust-text { margin-bottom: var(--space-5); }
    .divider { width: 48px; height: 1px; background: var(--accent); margin: var(--space-4) auto; opacity: 0.5; }

    /* =====================
       Survey
       ===================== */
    .survey-wrapper {
      display: none;
      min-height: 100dvh;
      width: 100%;
      align-items: center;
      justify-content: center;
      padding: var(--space-3);
      background: var(--bg-primary);
    }
    .survey-wrapper.active { display: flex; }

    .survey-card {
      width: 100%;
      max-width: 480px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: var(--radius-xl);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 580px;
    }

    .survey-header {
      padding: var(--space-3);
      border-bottom: 1px solid var(--border);
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    .progress-track {
      flex: 1;
      height: 2px;
      background: var(--bg-primary);
      border-radius: 2px;
      overflow: hidden;
    }
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent) 0%, var(--accent-light) 100%);
      width: 12.5%;
      transition: width 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .step-count {
      font-size: 0.75rem;
      color: var(--text-tertiary);
      letter-spacing: 0.05em;
      min-width: 44px;
      text-align: right;
    }

    .survey-content { flex: 1; padding: var(--space-5) var(--space-4); overflow-y: auto; }

    .question-screen {
      display: none;
      flex-direction: column;
      animation: fadeUp 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .question-screen.active { display: flex; }
    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .q-header { margin-bottom: var(--space-4); }
    .q-label { display: block; margin-bottom: var(--space-1); }
    .q-title { margin-bottom: var(--space-1); }
    .q-subtitle { color: var(--text-tertiary); }

    /* Phase Label */
    .phase-label {
      display: inline-block;
      padding: 6px 12px;
      background: var(--accent-dim);
      border-radius: 100px;
      font-size: 0.6875rem;
      font-weight: 500;
      letter-spacing: 0.1em;
      color: var(--accent-light);
      margin-bottom: var(--space-2);
    }

    .options-grid { display: flex; flex-direction: column; gap: 10px; }

    .option-card {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: var(--space-2) var(--space-2) var(--space-2) var(--space-3);
      background: transparent;
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.25s ease;
      user-select: none;
    }
    .option-card:hover { border-color: var(--text-dim); background: rgba(255,255,255,0.02); }
    .option-card.selected { border-color: var(--accent); background: var(--accent-dim); }
    .option-card span { font-size: 0.9375rem; font-weight: 400; color: var(--text-secondary); transition: color 0.25s ease; }
    .option-card.selected span { color: var(--text-white); }

    .indicator {
      width: 20px; height: 20px;
      border: 1.5px solid var(--text-dim);
      border-radius: 50%;
      position: relative;
      flex-shrink: 0;
      transition: all 0.25s ease;
    }
    .options-grid[data-type="multi"] .indicator { border-radius: 5px; }
    .option-card.selected .indicator { background: var(--accent); border-color: var(--accent); }
    .option-card.selected .indicator::after {
      content: '';
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      width: 8px; height: 8px;
      background: var(--bg-primary);
      border-radius: 50%;
    }
    .options-grid[data-type="multi"] .option-card.selected .indicator::after {
      width: 10px; height: 6px;
      background: transparent;
      border-left: 2px solid var(--bg-primary);
      border-bottom: 2px solid var(--bg-primary);
      border-radius: 0;
      transform: translate(-50%, -60%) rotate(-45deg);
    }

    .survey-footer {
      padding: var(--space-3) var(--space-4) var(--space-4);
      border-top: 1px solid var(--border);
    }

    /* =====================
       Result
       ===================== */
    .result-screen { text-align: center; }

    .result-icon {
      width: 72px; height: 72px;
      background: var(--success-dim);
      border: 1px solid var(--border-success);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto var(--space-3);
    }
    .result-icon svg { width: 32px; height: 32px; stroke: var(--success); fill: none; stroke-width: 1.5; }

    .result-header { margin-bottom: var(--space-4); }
    .result-header .text-label { display: block; margin-bottom: var(--space-1); }

    .result-box {
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-3);
      margin-bottom: var(--space-3);
      text-align: left;
    }
    .res-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
    }
    .res-item:last-child { border-bottom: none; }
    .res-key { font-size: 0.8125rem; color: var(--text-tertiary); }
    .res-val { font-size: 0.875rem; font-weight: 500; color: var(--text-white); }

    .result-message {
      background: var(--accent-dim);
      border: 1px solid var(--border-accent);
      border-radius: var(--radius-md);
      padding: var(--space-3);
      margin-bottom: var(--space-4);
    }
    .result-message p { font-size: 0.9375rem; line-height: 1.7; color: var(--text-primary); }

    /* Tier Section */
    .tier-section { margin-bottom: var(--space-4); text-align: left; }
    .tier-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: var(--space-2);
    }
    .tier-badge {
      padding: 4px 10px;
      background: var(--accent);
      border-radius: 100px;
      font-size: 0.6875rem;
      font-weight: 600;
      color: var(--bg-primary);
      letter-spacing: 0.05em;
    }
    .tier-badge.special {
      background: linear-gradient(135deg, #c9a227 0%, #f4d03f 50%, #c9a227 100%);
      animation: shimmer 2s ease-in-out infinite;
    }
    @keyframes shimmer {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    .tier-title { font-size: 0.875rem; font-weight: 500; color: var(--text-white); }

    .tier-card {
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-2);
      margin-bottom: 8px;
    }
    .tier-card.highlight {
      border-color: var(--border-accent);
      background: var(--accent-glow);
    }
    .tier-card.special {
      border-color: rgba(201, 162, 39, 0.3);
      background: rgba(201, 162, 39, 0.05);
    }
    .tier-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px 0;
    }
    .tier-icon { font-size: 0.875rem; line-height: 1.4; }
    .tier-content { display: flex; flex-direction: column; gap: 2px; }
    .tier-content strong { font-size: 0.875rem; font-weight: 500; color: var(--text-white); }
    .tier-content span { font-size: 0.75rem; color: var(--text-tertiary); }

    /* Selected Notice */
    .selected-notice {
      background: linear-gradient(135deg, rgba(201, 162, 39, 0.1) 0%, rgba(244, 208, 63, 0.05) 100%);
      border: 1px solid rgba(201, 162, 39, 0.25);
      border-radius: var(--radius-md);
      padding: var(--space-3);
      margin-bottom: var(--space-3);
      text-align: center;
    }
    .selected-notice p {
      font-size: 0.875rem;
      line-height: 1.7;
      color: #f4d03f;
    }
    .selected-notice strong { color: #fff; }

    /* Form Section */
    .form-section {
      background: var(--bg-primary);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      padding: var(--space-3);
      margin-bottom: var(--space-3);
    }
    .form-section .text-caption { margin-bottom: var(--space-2); text-align: center; }
    .form-group { margin-bottom: var(--space-2); }
    .form-group:last-child { margin-bottom: 0; }
    .form-label {
      display: block;
      font-size: 0.75rem;
      color: var(--text-tertiary);
      margin-bottom: 6px;
    }

    /* Counter */
    .spots-counter {
      text-align: center;
      margin-bottom: var(--space-3);
    }
    .spots-bar {
      height: 4px;
      background: var(--bg-primary);
      border-radius: 2px;
      margin-bottom: 8px;
      overflow: hidden;
    }
    .spots-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent) 0%, #c9a227 100%);
      width: 47%;
      transition: width 1s ease;
    }
    .spots-text { font-size: 0.8125rem; color: var(--text-secondary); }
    .spots-text strong { color: var(--accent-light); }

    .hidden { display: none !important; }

    /* PWA Install Banner */
    .install-banner {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-card);
      border-top: 1px solid var(--border-accent);
      padding: var(--space-3);
      z-index: 2000;
      animation: slideUp 0.4s ease;
    }
    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    .install-banner-content {
      max-width: 480px;
      margin: 0 auto;
      display: flex;
      align-items: center;
      gap: var(--space-2);
    }
    .install-banner-icon {
      width: 48px;
      height: 48px;
      background: var(--accent-dim);
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }
    .install-banner-icon svg {
      width: 28px;
      height: 28px;
      stroke: var(--accent-light);
      fill: none;
    }
    .install-banner-text {
      flex: 1;
    }
    .install-banner-text strong {
      display: block;
      font-size: 0.9375rem;
      margin-bottom: 2px;
    }
    .install-banner-text span {
      font-size: 0.8125rem;
      color: var(--text-tertiary);
    }
    .install-banner-btn {
      padding: 10px 16px;
      background: var(--accent);
      color: var(--bg-primary);
      border: none;
      border-radius: 100px;
      font-size: 0.8125rem;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
    }
    .install-banner-close {
      background: none;
      border: none;
      color: var(--text-dim);
      font-size: 1.25rem;
      cursor: pointer;
      padding: 4px;
    }

    /* Welcome Back */
    .welcome-back {
      position: fixed;
      top: var(--space-3);
      left: 50%;
      transform: translateX(-50%);
      background: var(--success);
      color: white;
      padding: 12px 20px;
      border-radius: 100px;
      font-size: 0.875rem;
      font-weight: 500;
      z-index: 1500;
      animation: fadeInDown 0.4s ease, fadeOut 0.4s ease 2.5s forwards;
    }
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateX(-50%) translateY(-20px); }
      to { opacity: 1; transform: translateX(-50%) translateY(0); }
    }
    @keyframes fadeOut {
      to { opacity: 0; }
    }

    /* Language Switcher */
    .lang-switcher {
      position: fixed;
      top: var(--space-3);
      right: var(--space-3);
      z-index: 1000;
      display: flex;
      background: var(--bg-card);
      border: 1px solid var(--border);
      border-radius: 100px;
      padding: 4px;
      gap: 4px;
    }
    .lang-btn {
      padding: 8px 14px;
      background: transparent;
      border: none;
      border-radius: 100px;
      font-family: var(--font-sans);
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--text-tertiary);
      cursor: pointer;
      transition: all 0.25s ease;
      letter-spacing: 0.02em;
      text-decoration: none;
    }
    .lang-btn:hover {
      color: var(--text-secondary);
    }
    .lang-btn.active {
      background: var(--accent);
      color: var(--bg-primary);
    }

    /* Mobile */
    @media (max-width: 640px) {
      :root {
        --space-3: 20px;
        --space-4: 28px;
        --space-5: 36px;
        --space-6: 44px;
        --space-8: 56px;
        --space-10: 72px;
        --space-12: 88px;
        --space-16: 112px;
      }
      .text-display { font-size: 2rem; }
      .text-h1 { font-size: 1.5rem; }
      .symptom-grid { grid-template-columns: 1fr; gap: 10px; }
      .symptom-icon { width: 44px; height: 44px; }
      .scroll-hint { display: none; }
      .survey-wrapper { padding: 0; }
      .survey-card { border-radius: 0; min-height: 100dvh; border: none; }
    }
  </style>
</head>
<body>

  <!-- PWA Install Banner -->
  <div class="install-banner hidden" id="installBanner">
    <div class="install-banner-content">
      <div class="install-banner-icon">
        <svg viewBox="0 0 24 24" stroke-width="2">
          <path d="M12 5v14M5 12l7 7 7-7"/>
        </svg>
      </div>
      <div class="install-banner-text">
        <strong>Add to Home Screen</strong>
        <span>Quick access like an app</span>
      </div>
      <button class="install-banner-btn" id="installBtn">Add</button>
      <button class="install-banner-close" id="installClose">√ó</button>
    </div>
  </div>

  <!-- Welcome Back -->
  <div class="welcome-back hidden" id="welcomeBack">
    Welcome back! üëã
  </div>

  <!-- Language Switcher -->
  <div class="lang-switcher">
    <a href="index.html" class="lang-btn">ÌïúÍµ≠Ïñ¥</a>
    <span class="lang-btn active">EN</span>
  </div>

  <!-- Landing -->
  <main class="landing" id="landing">
    <section class="hero">
      <div class="hero-content">
        <div class="hero-label"><span class="text-label">Self Check</span></div>
        <h1 class="text-display hero-headline">Tests say you're fine,<br>but <em>why do you still feel off?</em></h1>
        <p class="text-body-lg hero-sub">This page won't push any treatment.<br>Just a quiet moment to understand your current state.</p>
        <div class="hero-cta">
          <button class="btn-primary" id="startBtn">Start Your Check Now</button>
          <span class="text-micro">Takes about 1 min ¬∑ Get a personalized report</span>
        </div>
      </div>
      <div class="scroll-hint"><span class="text-micro">SCROLL</span></div>
    </section>

    <section class="empathy">
      <div class="container">
        <header class="section-header">
          <span class="text-label">Symptoms</span>
          <h2 class="text-h1">Does any of this sound familiar?</h2>
        </header>
        <div class="symptom-grid">
          <article class="symptom-card">
            <div class="symptom-content">
              <span class="text-label symptom-number">01</span>
              <p class="symptom-text">Test results are normal,<br>but your body still feels off</p>
            </div>
            <div class="symptom-icon">
              <svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="1.5">
                <rect x="8" y="4" width="24" height="32" rx="2"/>
                <path d="M16 12h8M16 18h8M16 24h4"/>
                <circle cx="34" cy="34" r="10"/>
                <path d="M34 30v4M34 38v1"/>
              </svg>
            </div>
          </article>
          <article class="symptom-card">
            <div class="symptom-content">
              <span class="text-label symptom-number">02</span>
              <p class="symptom-text">Doctors keep saying<br>"it's just stress"</p>
            </div>
            <div class="symptom-icon">
              <svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M12 28c0-8 6-14 14-14s14 6 14 14c0 4-2 7-5 9l-2 7H19l-2-7c-3-2-5-5-5-9z"/>
                <path d="M20 44h8"/>
                <path d="M22 28c0-2 2-4 4-4"/>
              </svg>
            </div>
          </article>
          <article class="symptom-card">
            <div class="symptom-content">
              <span class="text-label symptom-number">03</span>
              <p class="symptom-text">Sleep is broken, energy<br>fluctuates unpredictably</p>
            </div>
            <div class="symptom-icon">
              <svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="1.5">
                <path d="M36 24c0-8-6-14-13-14-1 0-2 0-3 .3 2 2 4 6 4 10.7 0 7-5 12-11 12-.7 0-1.3 0-2-.2C13 40 19 44 26 44c8 0 14-6 14-14 0-2-.4-4-1-6"/>
                <path d="M28 8l2-4M36 12l4-2M40 20h4"/>
              </svg>
            </div>
          </article>
          <article class="symptom-card">
            <div class="symptom-content">
              <span class="text-label symptom-number">04</span>
              <p class="symptom-text">You don't know what<br>to do next</p>
            </div>
            <div class="symptom-icon">
              <svg viewBox="0 0 48 48" fill="none" stroke="currentColor" stroke-width="1.5">
                <circle cx="24" cy="24" r="16"/>
                <path d="M18 20c0-4 3-6 6-6s6 2 6 5c0 3-2 4-4 5-1 1-2 2-2 4"/>
                <circle cx="24" cy="34" r="1.5" fill="currentColor"/>
              </svg>
            </div>
          </article>
        </div>
        <div class="message-block">
          <p class="text-body-lg">You don't have to figure this out alone.<br>We're building a program for people<br>with experiences just like yours.</p>
        </div>
        <div class="cta-wrapper">
          <div class="scarcity-counter">
            <span class="scarcity-dot"></span>
            <span class="scarcity-text">Pre-registered: 47 / 100</span>
          </div>
          <br><br>
          <button class="btn-ghost" id="startBtn2">Take the check & get your report</button>
        </div>
      </div>
    </section>

    <section class="trust">
      <div class="trust-content">
        <span class="text-label">Promise</span>
        <div class="divider"></div>
        <p class="text-body-lg trust-text">No diagnosis. No treatment push.<br><br>Just a <strong>calm, honest way</strong><br>to understand where you are.</p>
        <button class="btn-primary" id="startBtn3">Start the Check</button>
      </div>
    </section>
  </main>

  <!-- Survey -->
  <div class="survey-wrapper" id="surveyWrapper">
    <div class="survey-card">
      <header class="survey-header">
        <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
        <span class="step-count" id="stepCount">1 / 8</span>
      </header>

      <div class="survey-content">
        
        <!-- Phase 1: Status Check -->
        <!-- Q1 -->
        <div class="question-screen active" data-question="1">
          <header class="q-header">
            <span class="phase-label">STEP 1 ¬∑ STATUS CHECK</span>
            <h2 class="text-h2 q-title">How's your overall condition lately?</h2>
          </header>
          <div class="options-grid" data-type="single">
            <div class="option-card" data-value="good"><span>Generally okay</span><div class="indicator"></div></div>
            <div class="option-card" data-value="unstable"><span>Up and down</span><div class="indicator"></div></div>
            <div class="option-card" data-value="poor"><span>Consistently not good</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Q2 -->
        <div class="question-screen" data-question="2">
          <header class="q-header">
            <span class="phase-label">STEP 1 ¬∑ STATUS CHECK</span>
            <h2 class="text-h2 q-title">How's your sleep?</h2>
            <p class="text-caption q-subtitle">Based on the past 2 weeks</p>
          </header>
          <div class="options-grid" data-type="single">
            <div class="option-card" data-value="good"><span>I sleep well</span><div class="indicator"></div></div>
            <div class="option-card" data-value="light"><span>I wake often or sleep lightly</span><div class="indicator"></div></div>
            <div class="option-card" data-value="insomnia"><span>Hard to fall asleep</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Q3 -->
        <div class="question-screen" data-question="3">
          <header class="q-header">
            <span class="phase-label">STEP 1 ¬∑ STATUS CHECK</span>
            <h2 class="text-h2 q-title">Any physical discomfort?</h2>
            <p class="text-caption q-subtitle">Select all that apply</p>
          </header>
          <div class="options-grid" data-type="multi">
            <div class="option-card" data-value="chest"><span>Chest tightness</span><div class="indicator"></div></div>
            <div class="option-card" data-value="headache"><span>Headaches or dizziness</span><div class="indicator"></div></div>
            <div class="option-card" data-value="digestion"><span>Digestive issues</span><div class="indicator"></div></div>
            <div class="option-card" data-value="numbness"><span>Numbness or trembling</span><div class="indicator"></div></div>
            <div class="option-card" data-value="none"><span>Nothing specific</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Q4 -->
        <div class="question-screen" data-question="4">
          <header class="q-header">
            <span class="phase-label">STEP 1 ¬∑ STATUS CHECK</span>
            <h2 class="text-h2 q-title">How's your mental state?</h2>
          </header>
          <div class="options-grid" data-type="single">
            <div class="option-card" data-value="anxious"><span>Anxious or tense</span><div class="indicator"></div></div>
            <div class="option-card" data-value="exhausted"><span>Exhausted and drained</span><div class="indicator"></div></div>
            <div class="option-card" data-value="both"><span>Goes back and forth</span><div class="indicator"></div></div>
            <div class="option-card" data-value="calm"><span>Relatively calm</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Q5 -->
        <div class="question-screen" data-question="5">
          <header class="q-header">
            <span class="phase-label">STEP 1 ¬∑ STATUS CHECK</span>
            <h2 class="text-h2 q-title">How long have you felt this way?</h2>
          </header>
          <div class="options-grid" data-type="single">
            <div class="option-card" data-value="recent"><span>Just started recently</span><div class="indicator"></div></div>
            <div class="option-card" data-value="months"><span>A few months</span><div class="indicator"></div></div>
            <div class="option-card" data-value="long"><span>Over a year</span><div class="indicator"></div></div>
            <div class="option-card" data-value="unsure"><span>Not sure</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Phase 2: Market Validation -->
        <!-- Q6 -->
        <div class="question-screen" data-question="6">
          <header class="q-header">
            <span class="phase-label">STEP 2 ¬∑ PERSONALIZATION</span>
            <h2 class="text-h2 q-title">What have you tried<br>to address this?</h2>
            <p class="text-caption q-subtitle">Select all that apply</p>
          </header>
          <div class="options-grid" data-type="multi">
            <div class="option-card" data-value="doctor"><span>Doctor visits</span><div class="indicator"></div></div>
            <div class="option-card" data-value="alternative"><span>Alternative medicine</span><div class="indicator"></div></div>
            <div class="option-card" data-value="supplements"><span>Supplements</span><div class="indicator"></div></div>
            <div class="option-card" data-value="apps"><span>Meditation / wellness apps</span><div class="indicator"></div></div>
            <div class="option-card" data-value="exercise"><span>Exercise / yoga</span><div class="indicator"></div></div>
            <div class="option-card" data-value="therapy"><span>Therapy / counseling</span><div class="indicator"></div></div>
            <div class="option-card" data-value="nothing"><span>Nothing yet</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Q7 -->
        <div class="question-screen" data-question="7">
          <header class="q-header">
            <span class="phase-label">STEP 2 ¬∑ PERSONALIZATION</span>
            <h2 class="text-h2 q-title">What kind of support<br>would help most?</h2>
          </header>
          <div class="options-grid" data-type="single">
            <div class="option-card" data-value="1on1"><span>1-on-1 with a professional</span><div class="indicator"></div></div>
            <div class="option-card" data-value="app"><span>Self-guided via app</span><div class="indicator"></div></div>
            <div class="option-card" data-value="hybrid"><span>App + occasional expert feedback</span><div class="indicator"></div></div>
            <div class="option-card" data-value="offline"><span>In-person program</span><div class="indicator"></div></div>
            <div class="option-card" data-value="unsure"><span>Not sure</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Q8 -->
        <div class="question-screen" data-question="8">
          <header class="q-header">
            <span class="phase-label">STEP 2 ¬∑ PERSONALIZATION</span>
            <h2 class="text-h2 q-title">How much would you invest<br>monthly in a solution?</h2>
            <p class="text-caption q-subtitle">This helps us tailor recommendations</p>
          </header>
          <div class="options-grid" data-type="single">
            <div class="option-card" data-value="free"><span>Free only</span><div class="indicator"></div></div>
            <div class="option-card" data-value="$10-30"><span>$10‚Äì30</span><div class="indicator"></div></div>
            <div class="option-card" data-value="$30-50"><span>$30‚Äì50</span><div class="indicator"></div></div>
            <div class="option-card" data-value="$50-100"><span>$50‚Äì100</span><div class="indicator"></div></div>
            <div class="option-card" data-value="$100+"><span>$100+</span><div class="indicator"></div></div>
          </div>
        </div>

        <!-- Result Screen -->
        <div class="question-screen result-screen" id="resultScreen">
          <div class="result-icon">
            <svg viewBox="0 0 24 24" stroke="currentColor">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          
          <header class="result-header">
            <span class="text-label">Analysis Complete</span>
            <h2 class="text-h2">Your assessment is ready</h2>
          </header>
          
          <div class="result-box">
            <div class="res-item"><span class="res-key">Body</span><span class="res-val" id="resBody">-</span></div>
            <div class="res-item"><span class="res-key">Mind</span><span class="res-val" id="resMind">-</span></div>
            <div class="res-item"><span class="res-key">Duration</span><span class="res-val" id="resTime">-</span></div>
          </div>

          <div class="result-message">
            <p id="resultMessage">Analyzing...</p>
          </div>

          <!-- Selected users only -->
          <div class="selected-notice hidden" id="selectedNotice">
            <p>Based on your responses,<br><strong>professional support could be beneficial</strong>.<br>We're offering a <strong>special opportunity</strong> to selected participants.</p>
          </div>

          <!-- Tier 1: Everyone -->
          <div class="tier-section">
            <div class="tier-header">
              <span class="tier-badge">INSTANT</span>
              <span class="tier-title">Available right now</span>
            </div>
            <div class="tier-card">
              <div class="tier-item">
                <span class="tier-icon">üìä</span>
                <div class="tier-content">
                  <strong>Personalized Analysis Report</strong>
                  <span>Sent instantly via email</span>
                </div>
              </div>
              <div class="tier-item">
                <span class="tier-icon">üìò</span>
                <div class="tier-content">
                  <strong>Nervous System Guide</strong>
                  <span>Free PDF download</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Tier 2: Pre-registrants -->
          <div class="tier-section">
            <div class="tier-header">
              <span class="tier-badge">PRE-REGISTER</span>
              <span class="tier-title">If you sign up now</span>
            </div>
            <div class="tier-card highlight">
              <div class="tier-item">
                <span class="tier-icon">üéÅ</span>
                <div class="tier-content">
                  <strong>1 Month Free at Launch</strong>
                  <span>Limited to first 100 people</span>
                </div>
              </div>
              <div class="tier-item">
                <span class="tier-icon">‚ö°</span>
                <div class="tier-content">
                  <strong>Priority Beta Access</strong>
                  <span>Opening February</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Tier 3: Selected only -->
          <div class="tier-section hidden" id="tier3Section">
            <div class="tier-header">
              <span class="tier-badge special">SELECTED</span>
              <span class="tier-title">Exclusive to you</span>
            </div>
            <div class="tier-card special">
              <div class="tier-item">
                <span class="tier-icon">‚ú¶</span>
                <div class="tier-content">
                  <strong>Free Session with a Therapist</strong>
                  <span>Matched based on your responses</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Counter -->
          <div class="spots-counter">
            <div class="spots-bar"><div class="spots-fill"></div></div>
            <p class="spots-text"><strong>47</strong> people pre-registered (100 spots)</p>
          </div>

          <!-- Form -->
          <div class="form-section">
            <p class="text-caption">Enter your details to receive<br>your report and secure your spot</p>
            <div class="form-group">
              <label class="form-label">Email</label>
              <input type="email" class="input-field" id="inputEmail" placeholder="you@email.com">
            </div>
            <div class="form-group">
              <label class="form-label">Phone (optional)</label>
              <input type="tel" class="input-field" id="inputPhone" placeholder="+1 (555) 123-4567">
            </div>
          </div>

          <button class="btn-success" style="width:100%;" id="submitBtn">
            Get My Report & Pre-Register
          </button>
        </div>

        <!-- Complete Screen -->
        <div class="question-screen" id="completeScreen">
          <div class="result-icon" style="background: var(--success-dim); border-color: var(--border-success);">
            <svg viewBox="0 0 24 24" stroke="var(--success)" fill="none" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
          </div>
          <header class="result-header">
            <span class="text-label">Complete</span>
            <h2 class="text-h2">Check complete!</h2>
          </header>
          <div class="result-message" style="background: var(--success-dim); border-color: var(--border-success);">
            <p>We've sent your <strong>Personalized Analysis Report</strong> and<br><strong>Nervous System Guide</strong> to your email.<br><br>We'll notify you first when we launch!</p>
          </div>
          
          <!-- Check count -->
          <div style="background: var(--accent-dim); border: 1px solid var(--border-accent); border-radius: var(--radius-md); padding: var(--space-2); margin-bottom: var(--space-3); text-align: center;">
            <p style="font-size: 0.875rem; color: var(--text-secondary);">
              You've completed <strong style="color: var(--accent-light); font-size: 1.25rem;" id="checkCount">1</strong> check(s) so far
            </p>
          </div>
          
          <!-- Check again button -->
          <button class="btn-ghost" style="width: 100%; margin-bottom: var(--space-2);" onclick="location.reload()">
            Check Again
          </button>
          
          <p class="text-caption">Track your changes with regular check-ins</p>
        </div>

      </div>

      <footer class="survey-footer" id="surveyFooter">
        <button class="btn-primary is-disabled" id="nextBtn" style="width:100%;">Continue</button>
      </footer>
    </div>
  </div>

  <script>
    (function() {
      var HISTORY_KEY = 'mindcheck_history';
      var currentStep = 1;
      var totalSteps = 8;
      var answers = {};

      var landing = document.getElementById('landing');
      var surveyWrapper = document.getElementById('surveyWrapper');
      var nextBtn = document.getElementById('nextBtn');
      var progressFill = document.getElementById('progressFill');
      var stepCount = document.getElementById('stepCount');
      var surveyFooter = document.getElementById('surveyFooter');

      // Get history
      function getHistory() {
        try {
          return JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
        } catch (e) {
          return [];
        }
      }

      // Save to history
      function saveToHistory(data) {
        try {
          var history = getHistory();
          history.push({
            timestamp: Date.now(),
            date: new Date().toISOString(),
            answers: data.answers,
            email: data.email
          });
          if (history.length > 50) history = history.slice(-50);
          localStorage.setItem(HISTORY_KEY, JSON.stringify(history));
          return history.length;
        } catch (e) {
          return 0;
        }
      }

      var checkCount = getHistory().length;
      console.log('üìä Previous checks:', checkCount);

      function startSurvey() {
        landing.classList.add('hidden');
        surveyWrapper.classList.add('active');
        window.scrollTo(0, 0);
        currentStep = 1;
        answers = {};
        updateProgress();
        setButtonDisabled(true);
      }

      document.getElementById('startBtn').addEventListener('click', startSurvey);
      document.getElementById('startBtn2').addEventListener('click', startSurvey);
      document.getElementById('startBtn3').addEventListener('click', startSurvey);

      function setButtonDisabled(disabled) {
        if (disabled) {
          nextBtn.classList.add('is-disabled');
        } else {
          nextBtn.classList.remove('is-disabled');
        }
      }

      document.addEventListener('click', function(e) {
        var card = e.target.closest('.option-card');
        if (!card) return;

        var screen = card.closest('.question-screen');
        if (!screen || !screen.classList.contains('active')) return;
        if (screen.id === 'resultScreen' || screen.id === 'completeScreen') return;

        var grid = card.closest('.options-grid');
        var type = grid.getAttribute('data-type');
        var value = card.getAttribute('data-value');

        if (type === 'single') {
          var allCards = grid.querySelectorAll('.option-card');
          for (var i = 0; i < allCards.length; i++) {
            allCards[i].classList.remove('selected');
          }
          card.classList.add('selected');
        } else {
          if (value === 'none' || value === 'nothing') {
            var allCards = grid.querySelectorAll('.option-card');
            for (var i = 0; i < allCards.length; i++) {
              allCards[i].classList.remove('selected');
            }
            card.classList.add('selected');
          } else {
            var noneCards = grid.querySelectorAll('[data-value="none"], [data-value="nothing"]');
            for (var i = 0; i < noneCards.length; i++) {
              noneCards[i].classList.remove('selected');
            }
            card.classList.toggle('selected');
          }
        }

        checkSelection();
      });

      function checkSelection() {
        var screen = document.querySelector('.question-screen.active[data-question]');
        if (!screen) {
          setButtonDisabled(true);
          return;
        }
        var selected = screen.querySelectorAll('.option-card.selected');
        setButtonDisabled(selected.length === 0);
      }

      nextBtn.addEventListener('click', function() {
        if (nextBtn.classList.contains('is-disabled')) return;

        var screen = document.querySelector('.question-screen.active[data-question]');
        if (!screen) return;

        var selected = screen.querySelectorAll('.option-card.selected');
        if (selected.length === 0) return;

        var values = [];
        for (var i = 0; i < selected.length; i++) {
          values.push(selected[i].getAttribute('data-value'));
        }
        answers[currentStep] = values;

        if (currentStep < totalSteps) {
          screen.classList.remove('active');
          currentStep++;
          var nextScreen = document.querySelector('[data-question="' + currentStep + '"]');
          if (nextScreen) nextScreen.classList.add('active');
          updateProgress();
          setButtonDisabled(true);
        } else {
          showResult();
        }
      });

      function updateProgress() {
        var pct = (currentStep / totalSteps) * 100;
        progressFill.style.width = pct + '%';
        stepCount.textContent = currentStep + ' / ' + totalSteps;
      }

      function showResult() {
        var allScreens = document.querySelectorAll('.question-screen');
        for (var i = 0; i < allScreens.length; i++) {
          allScreens[i].classList.remove('active');
        }
        document.getElementById('resultScreen').classList.add('active');
        surveyFooter.style.display = 'none';
        generateResultText();
        checkTier3Eligibility();
      }

      function generateResultText() {
        var sleepMap = { 'good': 'Sleep is good', 'light': 'Sleep is unstable', 'insomnia': 'Difficulty sleeping' };
        var mindMap = { 'anxious': 'Tense / Anxious', 'exhausted': 'Drained / Fatigued', 'both': 'Fluctuating', 'calm': 'Relatively stable' };
        var timeMap = { 'recent': 'Recent onset', 'months': 'A few months', 'long': 'Over a year', 'unsure': 'Unclear' };

        var bodyParts = [];
        if (answers[2] && answers[2][0]) {
          bodyParts.push(sleepMap[answers[2][0]] || answers[2][0]);
        }
        if (answers[3] && answers[3].indexOf('none') === -1) {
          var symptomMap = { 'chest': 'Chest tightness', 'headache': 'Headaches', 'digestion': 'Digestive issues', 'numbness': 'Numbness' };
          for (var i = 0; i < answers[3].length; i++) {
            bodyParts.push(symptomMap[answers[3][i]] || answers[3][i]);
          }
        }
        document.getElementById('resBody').textContent = bodyParts.length > 0 ? bodyParts.join(', ') : 'No issues';

        var mind = answers[4] ? answers[4][0] : null;
        document.getElementById('resMind').textContent = mindMap[mind] || '-';

        var time = answers[5] ? answers[5][0] : null;
        document.getElementById('resTime').textContent = timeMap[time] || '-';

        var msgBox = document.getElementById('resultMessage');
        var sleep = answers[2] ? answers[2][0] : null;

        if (mind === 'calm' && sleep === 'good') {
          msgBox.textContent = 'Your current state appears relatively stable. Consistent self-care can help maintain this balance.';
        } else if (mind === 'both' || (sleep === 'insomnia' && mind !== 'calm')) {
          msgBox.textContent = 'Your nervous system may be seeking balance. The right support could help accelerate your recovery.';
        } else {
          msgBox.textContent = 'It\'s worth paying attention to both body and mind signals. Small changes can make a meaningful difference.';
        }
      }

      function checkTier3Eligibility() {
        var mind = answers[4] ? answers[4][0] : null;
        var time = answers[5] ? answers[5][0] : null;
        var sleep = answers[2] ? answers[2][0] : null;
        var bodySymptoms = answers[3] ? answers[3].length : 0;
        if (answers[3] && answers[3].indexOf('none') > -1) bodySymptoms = 0;

        var isEligible = false;
        if (mind === 'both' && time === 'long') isEligible = true;
        if (sleep === 'insomnia' && bodySymptoms >= 2) isEligible = true;

        if (isEligible) {
          document.getElementById('selectedNotice').classList.remove('hidden');
          document.getElementById('tier3Section').classList.remove('hidden');
        }
      }

      document.getElementById('submitBtn').addEventListener('click', function() {
        var email = document.getElementById('inputEmail').value.trim();
        var phone = document.getElementById('inputPhone').value.trim();

        if (!email) {
          alert('Please enter your email.');
          return;
        }

        // Save to history
        var totalChecks = saveToHistory({
          answers: answers,
          email: email,
          phone: phone
        });

        console.log('=== Collected Data ===');
        console.log('Survey answers:', answers);
        console.log('Email:', email);
        console.log('Phone:', phone);
        console.log('Total checks:', totalChecks);

        document.getElementById('resultScreen').classList.remove('active');
        document.getElementById('completeScreen').classList.add('active');
        
        // Show check count
        var checkCountEl = document.getElementById('checkCount');
        if (checkCountEl) {
          checkCountEl.textContent = totalChecks;
        }
      });

    })();
  </script>

  <!-- PWA + User Recognition -->
  <script>
    (function() {
      // =====================
      // Auto User ID
      // =====================
      var USER_KEY = 'mindcheck_user_id';
      var VISIT_KEY = 'mindcheck_visits';
      
      function getUserId() {
        var id = localStorage.getItem(USER_KEY);
        if (!id) {
          id = 'user_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
          localStorage.setItem(USER_KEY, id);
        }
        return id;
      }
      
      function recordVisit() {
        var visits = JSON.parse(localStorage.getItem(VISIT_KEY) || '[]');
        visits.push({
          timestamp: Date.now(),
          date: new Date().toISOString()
        });
        if (visits.length > 100) visits = visits.slice(-100);
        localStorage.setItem(VISIT_KEY, JSON.stringify(visits));
        return visits.length;
      }
      
      var userId = getUserId();
      var visitCount = recordVisit();
      
      console.log('üë§ User ID:', userId);
      console.log('üìä Visit count:', visitCount);
      
      // Welcome back (2+ visits)
      if (visitCount > 1 && visitCount <= 5) {
        var welcomeEl = document.getElementById('welcomeBack');
        if (welcomeEl) {
          welcomeEl.classList.remove('hidden');
          setTimeout(function() {
            welcomeEl.remove();
          }, 3000);
        }
      }
      
      // =====================
      // Service Worker
      // =====================
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
          navigator.serviceWorker.register('sw.js')
            .then(function(registration) {
              console.log('‚úÖ ServiceWorker registered:', registration.scope);
            })
            .catch(function(error) {
              console.log('‚ùå ServiceWorker failed:', error);
            });
        });
      }
      
      // =====================
      // PWA Install Banner
      // =====================
      var deferredPrompt;
      var installBanner = document.getElementById('installBanner');
      var installBtn = document.getElementById('installBtn');
      var installClose = document.getElementById('installClose');
      var INSTALL_DISMISSED_KEY = 'mindcheck_install_dismissed';
      
      var wasDismissed = localStorage.getItem(INSTALL_DISMISSED_KEY);
      var isStandalone = window.matchMedia('(display-mode: standalone)').matches || window.navigator.standalone;
      
      window.addEventListener('beforeinstallprompt', function(e) {
        e.preventDefault();
        deferredPrompt = e;
        
        if (!wasDismissed && !isStandalone && installBanner) {
          setTimeout(function() {
            installBanner.classList.remove('hidden');
          }, 3000);
        }
      });
      
      if (installBtn) {
        installBtn.addEventListener('click', function() {
          if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then(function(choiceResult) {
              if (choiceResult.outcome === 'accepted') {
                console.log('‚úÖ PWA installed');
              }
              deferredPrompt = null;
              installBanner.classList.add('hidden');
            });
          } else {
            alert('To add to Home Screen:\n\n1. Tap the Share button (‚ñ°‚Üë)\n2. Select "Add to Home Screen"');
            installBanner.classList.add('hidden');
          }
        });
      }
      
      if (installClose) {
        installClose.addEventListener('click', function() {
          installBanner.classList.add('hidden');
          localStorage.setItem(INSTALL_DISMISSED_KEY, 'true');
        });
      }
      
      window.addEventListener('appinstalled', function() {
        console.log('üéâ App installed!');
        installBanner.classList.add('hidden');
      });
      
    })();
  </script>

</body>
</html>
